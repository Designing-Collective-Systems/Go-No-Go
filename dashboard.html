<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go/No-Go Results</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --bg: #f7f7f5;
            --surface: #ffffff;
            --border: #e5e5e2;
            --border-strong: #d0d0cc;
            --text: #1a1a18;
            --text-secondary: #6b6b66;
            --text-muted: #9b9b96;
            --accent: #1a1a18;
            --go: #16a34a;
            --nogo: #dc2626;
            --warning: #d97706;
            --mono: 'DM Mono', monospace;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            font-size: 14px;
            line-height: 1.5;
        }

        /* ── Layout ── */
        #loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            font-size: 13px;
            color: var(--text-muted);
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        #dashboard { display: none; }

        .page-header {
            border-bottom: 1px solid var(--border);
            background: var(--surface);
            padding: 20px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 12px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .page-title {
            font-size: 15px;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .page-title span {
            font-weight: 300;
            color: var(--text-secondary);
        }

        .main-content {
            max-width: 1100px;
            margin: 0 auto;
            padding: 32px 24px 64px;
        }

        /* ── Phase Toggle ── */
        .phase-toggle {
            display: inline-flex;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            overflow: hidden;
            background: var(--surface);
        }

        .phase-toggle button {
            padding: 6px 16px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: background 0.12s, color 0.12s;
            border-right: 1px solid var(--border-strong);
        }

        .phase-toggle button:last-child { border-right: none; }

        .phase-toggle button.active {
            background: var(--accent);
            color: #ffffff;
        }

        /* ── Section ── */
        .section {
            margin-bottom: 40px;
        }

        .section-label {
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-label::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        /* ── Stat Grid ── */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 1px;
            background: var(--border);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .stat-cell {
            background: var(--surface);
            padding: 20px;
        }

        .stat-value {
            font-family: var(--mono);
            font-size: 22px;
            font-weight: 500;
            letter-spacing: -0.02em;
            color: var(--text);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .stat-value.go { color: var(--go); }
        .stat-value.nogo { color: var(--nogo); }
        .stat-value.warn { color: var(--warning); }

        /* ── Chart Card ── */
        .chart-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .chart-card + .chart-card { margin-top: 12px; }

        .chart-header {
            padding: 16px 20px 12px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .chart-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
        }

        .chart-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .chart-body {
            padding: 4px;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        @media (max-width: 680px) {
            .chart-grid { grid-template-columns: 1fr; }
            .stat-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .empty-state {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 160px;
            font-size: 13px;
            color: var(--text-muted);
        }

        /* ── Data Table ── */
        .table-wrap { overflow-x: auto; }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12.5px;
        }

        thead th {
            text-align: left;
            padding: 10px 14px;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.06em;
            text-transform: uppercase;
            color: var(--text-muted);
            background: var(--bg);
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        tbody td {
            padding: 9px 14px;
            border-bottom: 1px solid var(--border);
            font-family: var(--mono);
            color: var(--text-secondary);
            white-space: nowrap;
        }

        tbody tr:last-child td { border-bottom: none; }

        tbody tr:hover td { background: var(--bg); }

        .tag {
            display: inline-block;
            padding: 2px 7px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
            font-family: 'DM Sans', sans-serif;
        }

        .tag-go { background: #dcfce7; color: var(--go); }
        .tag-nogo { background: #fee2e2; color: var(--nogo); }
        .tag-yes { background: #dcfce7; color: var(--go); }
        .tag-no { background: #fee2e2; color: var(--nogo); }
        .tag-slip { background: #fef3c7; color: var(--warning); }

        /* ── Close button ── */
        .close-btn {
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            background: none;
            border: 1px solid var(--border-strong);
            border-radius: 6px;
            padding: 6px 14px;
            cursor: pointer;
            transition: border-color 0.12s, color 0.12s;
        }

        .close-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Plotly overrides */
        .plotly .modebar { display: none !important; }
    </style>
</head>
<body>

<div id="loading">Loading results&hellip;</div>

<div id="dashboard">
    <header class="page-header">
        <div class="page-title">Go/No-Go Task <span>/ Results</span></div>
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
            <div class="phase-toggle">
                <button id="btn-practice" onclick="setPhase('practice')">Practice</button>
                <button id="btn-real" onclick="setPhase('real')">Real Study</button>
                <button id="btn-both" onclick="setPhase('both')" class="active">Both</button>
            </div>
            <button class="close-btn" onclick="window.close()">Close</button>
        </div>
    </header>

    <main class="main-content">

        <!-- Summary stats -->
        <div class="section">
            <div class="section-label">Summary</div>
            <div class="stat-grid">
                <div class="stat-cell">
                    <div class="stat-value mono" id="stat-total-trials">—</div>
                    <div class="stat-label">Total trials</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-accuracy">—</div>
                    <div class="stat-label">Accuracy</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-go-accuracy">—</div>
                    <div class="stat-label">GO accuracy</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-nogo-accuracy">—</div>
                    <div class="stat-label">NO GO accuracy</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-slips">—</div>
                    <div class="stat-label">NO GO slips</div>
                </div>
            </div>
        </div>

        <!-- RT stats -->
        <div class="section">
            <div class="section-label">Reaction Times</div>
            <div class="stat-grid">
                <div class="stat-cell">
                    <div class="stat-value" id="stat-mean-rt-release">—</div>
                    <div class="stat-label">Mean RT-Release (ms)</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-median-rt-release">—</div>
                    <div class="stat-label">Median RT-Release (ms)</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-mean-rt-down">—</div>
                    <div class="stat-label">Mean RT-Down (ms)</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-mean-response-time">—</div>
                    <div class="stat-label">Mean Response Time (ms)</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-std-rt">—</div>
                    <div class="stat-label">RT-Release SD (ms)</div>
                </div>
                <div class="stat-cell">
                    <div class="stat-value" id="stat-mean-slip-duration">—</div>
                    <div class="stat-label">Mean Slip Duration (ms)</div>
                </div>
            </div>
        </div>

        <!-- RT charts -->
        <div class="section">
            <div class="section-label">Reaction Time Distribution</div>
            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">RT-Release</div>
                        <div class="chart-subtitle">GO trials only</div>
                    </div>
                    <div class="chart-body" id="chart-rt-release-hist"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">RT-Down</div>
                        <div class="chart-subtitle">Time to recontact after prompt</div>
                    </div>
                    <div class="chart-body" id="chart-rt-down-hist"></div>
                </div>
            </div>
        </div>

        <!-- Response time + slip duration -->
        <div class="section">
            <div class="section-label">Response Time &amp; Slip Duration</div>
            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Response Time by Trial</div>
                        <div class="chart-subtitle">RT-Release + RT-Down</div>
                    </div>
                    <div class="chart-body" id="chart-response-time"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Slip Duration</div>
                        <div class="chart-subtitle">NO GO slips only</div>
                    </div>
                    <div class="chart-body" id="chart-slip-duration"></div>
                </div>
            </div>
        </div>

        <!-- RT over trials -->
        <div class="section">
            <div class="section-label">Over Time</div>
            <div class="chart-card">
                <div class="chart-header">
                    <div class="chart-title">RT-Release across trials</div>
                    <div class="chart-subtitle">GO trials</div>
                </div>
                <div class="chart-body" id="chart-rt-by-trial"></div>
            </div>
        </div>

        <!-- Phase comparison (both only) -->
        <div id="comparison-section" class="section">
            <div class="section-label">Phase Comparison</div>
            <div class="chart-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">RT-Release distribution</div>
                    </div>
                    <div class="chart-body" id="chart-phase-box"></div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <div class="chart-title">Accuracy by phase</div>
                    </div>
                    <div class="chart-body" id="chart-phase-accuracy"></div>
                </div>
            </div>
        </div>

        <!-- Raw data -->
        <div class="section">
            <div class="section-label">Raw Data</div>
            <div class="chart-card">
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>Phase</th>
                                <th>Trial</th>
                                <th>Type</th>
                                <th>Correct</th>
                                <th>Result</th>
                                <th>RT-Release</th>
                                <th>RT-Down</th>
                                <th>Response Time</th>
                                <th>Slip Duration</th>
                                <th>Error</th>
                            </tr>
                        </thead>
                        <tbody id="data-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>

    </main>
</div>

<script>
    let allData = [];
    let currentPhase = 'both';

    // ── Data reception ──
    window.addEventListener('message', (event) => {
        if (event.data.type === 'GO_NOGO_DATA') {
            allData = event.data.data;
            initializeDashboard();
        }
    });

    window.addEventListener('load', () => {
        const storedData = localStorage.getItem('goNoGoResults');
        if (storedData && allData.length === 0) {
            allData = JSON.parse(storedData);
            initializeDashboard();
        }
    });

    function initializeDashboard() {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        updateDashboard();
    }

    function setPhase(phase) {
        currentPhase = phase;
        document.querySelectorAll('.phase-toggle button').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`btn-${phase}`).classList.add('active');
        document.getElementById('comparison-section').style.display = phase === 'both' ? '' : 'none';
        updateDashboard();
    }

    function filterData() {
        if (currentPhase === 'both') return allData;
        if (currentPhase === 'practice') return allData.filter(d => d.phase === 'Practice');
        return allData.filter(d => d.phase === 'Real Study');
    }

    function updateDashboard() {
        const data = filterData();
        updateStats(data);
        plotHistogram('chart-rt-release-hist', data.filter(d => d.trialType === 'go' && d.rtRelease != null).map(d => d.rtRelease), 'RT-Release (ms)');
        plotHistogram('chart-rt-down-hist', data.filter(d => d.trialType === 'go' && d.rtDown != null).map(d => d.rtDown), 'RT-Down (ms)');
        plotResponseTime(data);
        plotSlipDuration(data);
        plotRTByTrial(data);
        updateDataTable(data);
        if (currentPhase === 'both') plotPhaseComparison();
    }

    // ── Stats ──
    function median(arr) {
        if (!arr.length) return null;
        const s = [...arr].sort((a, b) => a - b);
        const m = Math.floor(s.length / 2);
        return s.length % 2 ? s[m] : (s[m - 1] + s[m]) / 2;
    }

    function mean(arr) {
        if (!arr.length) return null;
        return arr.reduce((a, b) => a + b, 0) / arr.length;
    }

    function stddev(arr) {
        const m = mean(arr);
        if (m === null) return null;
        return Math.sqrt(arr.reduce((s, v) => s + Math.pow(v - m, 2), 0) / arr.length);
    }

    function fmt(val, decimals = 0) {
        return val != null ? val.toFixed(decimals) : '—';
    }

    function updateStats(data) {
        const validTrials = data.filter(d => d.trialType !== 'pending');
        const uniqueTrials = [...new Set(data.map(d => `${d.phase}-${d.trialIndex}`))].length;

        const correct = validTrials.filter(d => d.isCorrect).length;
        const accuracy = validTrials.length > 0 ? (correct / validTrials.length) * 100 : null;

        const goTrials = data.filter(d => d.trialType === 'go');
        const goCorrect = goTrials.filter(d => d.isCorrect).length;
        const goAcc = goTrials.length > 0 ? (goCorrect / goTrials.length) * 100 : null;

        const nogoTrials = data.filter(d => d.trialType === 'nogo');
        const nogoCorrect = nogoTrials.filter(d => d.isCorrect && d.resultType === 'Success').length;
        const nogoAcc = nogoTrials.length > 0 ? (nogoCorrect / nogoTrials.length) * 100 : null;

        const slips = data.filter(d => d.resultType === 'Slip Recorded').length;

        const rtReleaseVals = data.filter(d => d.trialType === 'go' && d.rtRelease != null).map(d => d.rtRelease);
        const rtDownVals = data.filter(d => d.trialType === 'go' && d.rtDown != null).map(d => d.rtDown);
        const responseTimeVals = data.filter(d => d.responseTime != null).map(d => d.responseTime);
        const slipDurationVals = data.filter(d => d.slipDuration != null).map(d => d.slipDuration);

        set('stat-total-trials', uniqueTrials);
        set('stat-accuracy', accuracy != null ? accuracy.toFixed(1) + '%' : '—');
        set('stat-go-accuracy', goAcc != null ? goAcc.toFixed(1) + '%' : '—');
        set('stat-nogo-accuracy', nogoAcc != null ? nogoAcc.toFixed(1) + '%' : '—');
        set('stat-slips', slips);
        set('stat-mean-rt-release', fmt(mean(rtReleaseVals)));
        set('stat-median-rt-release', fmt(median(rtReleaseVals)));
        set('stat-mean-rt-down', fmt(mean(rtDownVals)));
        set('stat-mean-response-time', fmt(mean(responseTimeVals)));
        set('stat-std-rt', fmt(stddev(rtReleaseVals), 1));
        set('stat-mean-slip-duration', slipDurationVals.length ? fmt(mean(slipDurationVals)) : '—');
    }

    function set(id, val) {
        const el = document.getElementById(id);
        if (el) el.textContent = val;
    }

    // ── Shared Plotly config ──
    const PLOTLY_CONFIG = { displayModeBar: false, responsive: true };

    const PLOTLY_LAYOUT_BASE = {
        paper_bgcolor: 'transparent',
        plot_bgcolor: 'transparent',
        font: { family: 'DM Sans, sans-serif', size: 11, color: '#6b6b66' },
        margin: { t: 12, r: 16, b: 40, l: 48 },
        xaxis: { gridcolor: '#e5e5e2', linecolor: '#d0d0cc', tickcolor: '#d0d0cc', zeroline: false },
        yaxis: { gridcolor: '#e5e5e2', linecolor: '#d0d0cc', tickcolor: '#d0d0cc', zeroline: false },
        legend: { bgcolor: 'transparent', borderwidth: 0 }
    };

    function layout(overrides = {}) {
        return Object.assign({}, PLOTLY_LAYOUT_BASE, overrides, {
            xaxis: Object.assign({}, PLOTLY_LAYOUT_BASE.xaxis, overrides.xaxis || {}),
            yaxis: Object.assign({}, PLOTLY_LAYOUT_BASE.yaxis, overrides.yaxis || {})
        });
    }

    function emptyState(id) {
        document.getElementById(id).innerHTML =
            '<div class="empty-state">Not enough data</div>';
    }

    // ── Charts ──
    function plotHistogram(id, vals, xLabel) {
        if (vals.length < 2) { emptyState(id); return; }
        const trace = {
            x: vals,
            type: 'histogram',
            marker: { color: '#1a1a18', opacity: 0.75 },
            xbins: { size: 50 }
        };
        Plotly.newPlot(id, [trace], layout({
            height: 200,
            xaxis: { title: xLabel, rangemode: 'tozero' },
            yaxis: { title: 'Count', rangemode: 'tozero' }
        }), PLOTLY_CONFIG);
    }

    function plotResponseTime(data) {
        const rows = data.filter(d => d.responseTime != null);
        if (!rows.length) { emptyState('chart-response-time'); return; }
        const trace = {
            x: rows.map(d => d.trialIndex),
            y: rows.map(d => d.responseTime),
            mode: 'markers',
            type: 'scatter',
            marker: { color: '#1a1a18', size: 7, opacity: 0.8 }
        };
        Plotly.newPlot('chart-response-time', [trace], layout({
            height: 200,
            xaxis: { title: 'Trial', rangemode: 'tozero' },
            yaxis: { title: 'ms', rangemode: 'tozero' }
        }), PLOTLY_CONFIG);
    }

    function plotSlipDuration(data) {
        const vals = data.filter(d => d.slipDuration != null).map(d => d.slipDuration);
        if (!vals.length) { emptyState('chart-slip-duration'); return; }
        const trace = {
            y: vals,
            type: 'box',
            marker: { color: '#d97706' },
            line: { color: '#d97706' },
            fillcolor: 'rgba(217,119,6,0.15)',
            boxpoints: 'all',
            jitter: 0.4,
            pointpos: -1.5
        };
        Plotly.newPlot('chart-slip-duration', [trace], layout({
            height: 200,
            yaxis: { title: 'ms', rangemode: 'tozero' },
            xaxis: { visible: false }
        }), PLOTLY_CONFIG);
    }

    function plotRTByTrial(data) {
        const rows = data.filter(d => d.trialType === 'go' && d.rtRelease != null);
        if (!rows.length) { emptyState('chart-rt-by-trial'); return; }

        const traces = [];
        const phases = currentPhase === 'both'
            ? ['Practice', 'Real Study']
            : [currentPhase === 'practice' ? 'Practice' : 'Real Study'];

        const colors = { 'Practice': '#9b9b96', 'Real Study': '#1a1a18' };

        phases.forEach(ph => {
            const phRows = rows.filter(d => d.phase === ph);
            if (!phRows.length) return;
            traces.push({
                x: phRows.map(d => d.trialIndex),
                y: phRows.map(d => d.rtRelease),
                mode: 'lines+markers',
                name: ph,
                line: { color: colors[ph], width: 1.5 },
                marker: { color: colors[ph], size: 6 }
            });
        });

        Plotly.newPlot('chart-rt-by-trial', traces, layout({
            height: 240,
            xaxis: { title: 'Trial', rangemode: 'tozero' },
            yaxis: { title: 'RT-Release (ms)', rangemode: 'tozero' }
        }), PLOTLY_CONFIG);
    }

    function plotPhaseComparison() {
        const practiceRTs = allData.filter(d => d.phase === 'Practice' && d.trialType === 'go' && d.rtRelease != null).map(d => d.rtRelease);
        const realRTs = allData.filter(d => d.phase === 'Real Study' && d.trialType === 'go' && d.rtRelease != null).map(d => d.rtRelease);

        const boxTraces = [];
        if (practiceRTs.length) boxTraces.push({ y: practiceRTs, type: 'box', name: 'Practice', marker: { color: '#9b9b96' }, line: { color: '#9b9b96' }, fillcolor: 'rgba(155,155,150,0.15)' });
        if (realRTs.length) boxTraces.push({ y: realRTs, type: 'box', name: 'Real Study', marker: { color: '#1a1a18' }, line: { color: '#1a1a18' }, fillcolor: 'rgba(26,26,24,0.12)' });

        Plotly.newPlot('chart-phase-box', boxTraces, layout({
            height: 220,
            yaxis: { title: 'RT-Release (ms)', rangemode: 'tozero' }
        }), PLOTLY_CONFIG);

        // Accuracy comparison
        const phases = ['Practice', 'Real Study'];
        const accs = phases.map(ph => {
            const phData = allData.filter(d => d.phase === ph && d.trialType !== 'pending');
            if (!phData.length) return 0;
            return (phData.filter(d => d.isCorrect).length / phData.length) * 100;
        });

        Plotly.newPlot('chart-phase-accuracy', [{
            x: phases,
            y: accs,
            type: 'bar',
            marker: { color: ['#9b9b96', '#1a1a18'] }
        }], layout({
            height: 220,
            yaxis: { title: 'Accuracy (%)', range: [0, 105] },
            xaxis: { tickfont: { size: 12 } }
        }), PLOTLY_CONFIG);
    }

    // ── Data table ──
    function updateDataTable(data) {
        const tbody = document.getElementById('data-table-body');
        tbody.innerHTML = '';

        data.forEach(d => {
            const tr = document.createElement('tr');
            const isSlip = d.resultType === 'Slip Recorded';
            const typeTag = d.trialType === 'go'
                ? '<span class="tag tag-go">GO</span>'
                : d.trialType === 'nogo'
                    ? '<span class="tag tag-nogo">NO GO</span>'
                    : `<span class="tag">${d.trialType}</span>`;
            const correctTag = isSlip
                ? '<span class="tag tag-slip">slip</span>'
                : d.isCorrect
                    ? '<span class="tag tag-yes">yes</span>'
                    : '<span class="tag tag-no">no</span>';

            tr.innerHTML = `
                <td>${d.phase}</td>
                <td>${d.trialIndex}</td>
                <td>${typeTag}</td>
                <td>${correctTag}</td>
                <td>${d.resultType || '—'}</td>
                <td>${d.rtRelease != null ? d.rtRelease.toFixed(0) : (d.rt != null ? d.rt.toFixed(0) : '—')}</td>
                <td>${d.rtDown != null ? d.rtDown.toFixed(0) : '—'}</td>
                <td>${d.responseTime != null ? d.responseTime.toFixed(0) : '—'}</td>
                <td>${d.slipDuration != null ? d.slipDuration.toFixed(0) : '—'}</td>
                <td>${d.errorCategory === 'None' || !d.errorCategory ? '—' : d.errorCategory}</td>
            `;
            tbody.appendChild(tr);
        });
    }
</script>
</body>
</html>